import requests
import urllib, os
import json
import math
import datetime
import time
import re


# Determine if a point is inside a given polygon or not
# Polygon is a list of (x,y) pairs. This function
# returns True or False.  The algorithm is called
# the "Ray Casting Method".

def point_in_poly(x,y,poly):

    n = len(poly)
    inside = False

    p1x,p1y = poly[0]
    for i in range(n+1):
        p2x,p2y = poly[i % n]
        if y > min(p1y,p2y):
            if y <= max(p1y,p2y):
                if x <= max(p1x,p2x):
                    if p1y != p2y:
                        xints = (y-p1y)*(p2x-p1x)/(p2y-p1y)+p1x
                    if p1x == p2x or x <= xints:
                        inside = not inside
        p1x,p1y = p2x,p2y

    return inside


# un delta de [0.000180] equivale aprox. a 20m
DELTA = 0.000180
DELTA2 = 0.000360

# zone search template javaScript absolute file system path
# This holds search coordinates

cityZone = 'kennedy'


imgsJsPath = '/vagrant/ggStreetView/map/localidades/%s/imgs/set_%s.js' % (cityZone, cityZone)
imgsJsDirPath = '/vagrant/ggStreetView/map/localidades/%s/imgs' % cityZone



# Zone polygone
polygon = [
              (-74.158572,4.662739),
              (-74.158816,4.662608),
              (-74.15913,4.662532),
              (-74.160319,4.662708),
              (-74.160857,4.662882),
              (-74.161235,4.663064),
              (-74.161733,4.663261),
              (-74.161962,4.663305),
              (-74.162288,4.663366),
              (-74.162532,4.66317),
              (-74.162759,4.662905),
              (-74.162866,4.662618),
              (-74.162984,4.662268),
              (-74.162975,4.661855),
              (-74.162989,4.661196),
              (-74.162974,4.660646),
              (-74.162948,4.660182),
              (-74.163002,4.659683),
              (-74.163154,4.659309),
              (-74.163347,4.659056),
              (-74.163933,4.65864),
              (-74.16404,4.658565),
              (-74.164486,4.658636),
              (-74.164887,4.658771),
              (-74.165238,4.659136),
              (-74.165514,4.659455),
              (-74.165641,4.659718),
              (-74.165939,4.659854),
              (-74.166207,4.659875),
              (-74.166373,4.659771),
              (-74.166526,4.659615),
              (-74.16666,4.659219),
              (-74.166738,4.658754),
              (-74.166701,4.658411),
              (-74.166812,4.657854),
              (-74.166998,4.657377),
              (-74.167216,4.656671),
              (-74.167654,4.656382),
              (-74.16795,4.656288),
              (-74.169013,4.656259),
              (-74.169487,4.656279),
              (-74.169876,4.656471),
              (-74.170479,4.656943),
              (-74.170909,4.65717),
              (-74.17136,4.657259),
              (-74.171586,4.657276),
              (-74.171835,4.657296),
              (-74.172336,4.657144),
              (-74.172643,4.656901),
              (-74.173092,4.656474),
              (-74.17382,4.656017),
              (-74.174195,4.655711),
              (-74.174479,4.655365),
              (-74.174909,4.654732),
              (-74.175416,4.654477),
              (-74.176016,4.654628),
              (-74.176577,4.654785),
              (-74.17755,4.654252),
              (-74.177703,4.654062),
              (-74.178369,4.653576),
              (-74.178909,4.653263),
              (-74.179638,4.652892),
              (-74.180076,4.65262),
              (-74.18049,4.65213),
              (-74.180716,4.651745),
              (-74.181048,4.650889),
              (-74.181767,4.64983),
              (-74.182231,4.649191),
              (-74.182725,4.648712),
              (-74.183418,4.64814),
              (-74.184129,4.647557),
              (-74.184806,4.647106),
              (-74.185273,4.646994),
              (-74.185666,4.647046),
              (-74.184799,4.644968),
              (-74.183652,4.642468),
              (-74.182484,4.640038),
              (-74.18034,4.635423),
              (-74.18025,4.635261),
              (-74.179896,4.63449),
              (-74.179163,4.632852),
              (-74.178637,4.631654),
              (-74.178146,4.630473),
              (-74.178035,4.630229),
              (-74.177803,4.629681),
              (-74.177702,4.629367),
              (-74.17756,4.628708),
              (-74.177312,4.627932),
              (-74.177302,4.62779),
              (-74.177201,4.626948),
              (-74.177009,4.625477),
              (-74.176858,4.624831),
              (-74.176809,4.624731),
              (-74.176766,4.624606),
              (-74.176722,4.624462),
              (-74.176676,4.624326),
              (-74.176631,4.624188),
              (-74.176579,4.62407),
              (-74.176561,4.62402),
              (-74.176619,4.62397),
              (-74.176681,4.62393),
              (-74.176861,4.623815),
              (-74.177002,4.623724),
              (-74.177164,4.623613),
              (-74.177344,4.623489),
              (-74.177507,4.62339),
              (-74.177668,4.62329),
              (-74.177707,4.623252),
              (-74.177731,4.623208),
              (-74.177732,4.623182),
              (-74.177688,4.623128),
              (-74.177637,4.623059),
              (-74.177608,4.623006),
              (-74.177555,4.62291),
              (-74.177485,4.622797),
              (-74.177392,4.622647),
              (-74.177329,4.622558),
              (-74.177288,4.622478),
              (-74.177276,4.622428),
              (-74.177277,4.622393),
              (-74.177238,4.622355),
              (-74.177288,4.622313),
              (-74.177364,4.622245),
              (-74.177474,4.622151),
              (-74.177519,4.622113),
              (-74.177664,4.621985),
              (-74.17779,4.621891),
              (-74.17794,4.621743),
              (-74.178115,4.621589),
              (-74.178268,4.621453),
              (-74.178424,4.621315),
              (-74.17856,4.621188),
              (-74.178685,4.621056),
              (-74.178831,4.620928),
              (-74.178978,4.620788),
              (-74.179117,4.620657),
              (-74.179251,4.620525),
              (-74.179399,4.620392),
              (-74.179566,4.620259),
              (-74.179669,4.620159),
              (-74.179693,4.620126),
              (-74.179725,4.620047),
              (-74.179707,4.619991),
              (-74.179652,4.619917),
              (-74.179615,4.61986),
              (-74.179528,4.619749),
              (-74.179401,4.619604),
              (-74.179274,4.619461),
              (-74.179179,4.619332),
              (-74.179152,4.619244),
              (-74.17922,4.619175),
              (-74.17936,4.619061),
              (-74.179538,4.618921),
              (-74.17969,4.618807),
              (-74.179701,4.618793),
              (-74.179843,4.618697),
              (-74.180003,4.618568),
              (-74.180104,4.618486),
              (-74.180158,4.618529),
              (-74.180217,4.618576),
              (-74.180273,4.618649),
              (-74.180387,4.61879),
              (-74.180462,4.618863),
              (-74.180524,4.618913),
              (-74.180685,4.618972),
              (-74.18072,4.618978),
              (-74.180851,4.619014),
              (-74.181023,4.619032),
              (-74.181194,4.619036),
              (-74.181359,4.61905),
              (-74.181493,4.619039),
              (-74.181698,4.618972),
              (-74.181855,4.618939),
              (-74.18203,4.618898),
              (-74.182201,4.618844),
              (-74.182368,4.618811),
              (-74.182504,4.618788),
              (-74.18259,4.618805),
              (-74.182632,4.618821),
              (-74.182687,4.618843),
              (-74.182844,4.618907),
              (-74.182997,4.618955),
              (-74.183062,4.618959),
              (-74.18338,4.619132),
              (-74.18403,4.619013),
              (-74.184049,4.619021),
              (-74.184234,4.618999),
              (-74.184448,4.618959),
              (-74.18461,4.618936),
              (-74.184775,4.618909),
              (-74.184947,4.618884),
              (-74.185104,4.618876),
              (-74.185235,4.618855),
              (-74.185232,4.618764),
              (-74.185231,4.618744),
              (-74.185225,4.618624),
              (-74.185226,4.61861),
              (-74.185219,4.618488),
              (-74.185202,4.618348),
              (-74.185201,4.618235),
              (-74.185179,4.618083),
              (-74.185163,4.617942),
              (-74.185166,4.617825),
              (-74.185155,4.61768),
              (-74.185146,4.617548),
              (-74.185123,4.617423),
              (-74.185142,4.617299),
              (-74.185149,4.617149),
              (-74.185149,4.617016),
              (-74.185152,4.616882),
              (-74.185148,4.616749),
              (-74.185147,4.616624),
              (-74.18514,4.61656),
              (-74.185141,4.616495),
              (-74.185144,4.616375),
              (-74.185142,4.616348),
              (-74.185142,4.616216),
              (-74.185138,4.616079),
              (-74.185132,4.615949),
              (-74.18513,4.615785),
              (-74.18512,4.61575),
              (-74.185098,4.615722),
              (-74.185068,4.615696),
              (-74.185039,4.615675),
              (-74.184927,4.615647),
              (-74.184785,4.615625),
              (-74.18475,4.615741),
              (-74.184666,4.61582),
              (-74.184486,4.615974),
              (-74.184342,4.616079),
              (-74.184279,4.616121),
              (-74.184062,4.616277),
              (-74.184013,4.616334),
              (-74.183971,4.616384),
              (-74.183801,4.616619),
              (-74.183652,4.61681),
              (-74.183549,4.616934),
              (-74.183393,4.617127),
              (-74.183097,4.617186),
              (-74.182932,4.617161),
              (-74.182752,4.617124),
              (-74.182636,4.61705),
              (-74.182575,4.617011),
              (-74.182426,4.616786),
              (-74.182368,4.616554),
              (-74.18237,4.616521),
              (-74.182463,4.616316),
              (-74.182479,4.616274),
              (-74.182638,4.616084),
              (-74.182696,4.616011),
              (-74.182729,4.615985),
              (-74.182764,4.615943),
              (-74.182815,4.615878),
              (-74.182934,4.615595),
              (-74.182979,4.61537),
              (-74.182864,4.615264),
              (-74.182684,4.615199),
              (-74.182464,4.615147),
              (-74.182232,4.615005),
              (-74.182103,4.614824),
              (-74.182026,4.614655),
              (-74.181587,4.614798),
              (-74.181136,4.615471),
              (-74.18084,4.615949),
              (-74.180672,4.61626),
              (-74.18053,4.616545),
              (-74.180208,4.61692),
              (-74.180079,4.61701),
              (-74.17986,4.616907),
              (-74.17964,4.616635),
              (-74.179498,4.616428),
              (-74.179395,4.616144),
              (-74.179421,4.615937),
              (-74.17964,4.615548),
              (-74.179756,4.615354),
              (-74.179937,4.615114),
              (-74.179939,4.615109),
              (-74.180072,4.61494),
              (-74.180219,4.614834),
              (-74.180442,4.614794),
              (-74.180699,4.614774),
              (-74.181053,4.614775),
              (-74.181286,4.614713),
              (-74.181615,4.614539),
              (-74.181764,4.614433),
              (-74.181799,4.614389),
              (-74.181904,4.614261),
              (-74.18185,4.61415),
              (-74.181668,4.613989),
              (-74.181522,4.613851),
              (-74.181433,4.613704),
              (-74.181388,4.613597),
              (-74.181362,4.613499),
              (-74.181353,4.613356),
              (-74.181339,4.613218),
              (-74.181286,4.613066),
              (-74.181193,4.612959),
              (-74.180966,4.612852),
              (-74.180486,4.612625),
              (-74.180045,4.612352),
              (-74.179917,4.612273),
              (-74.179135,4.611791),
              (-74.178935,4.611667),
              (-74.178048,4.610955),
              (-74.177347,4.609791),
              (-74.177292,4.609619),
              (-74.177261,4.609408),
              (-74.177284,4.609197),
              (-74.177355,4.609026),
              (-74.177495,4.60883),
              (-74.177674,4.608658),
              (-74.177783,4.608432),
              (-74.177822,4.608276),
              (-74.177845,4.608088),
              (-74.177814,4.607838),
              (-74.177744,4.607635),
              (-74.177604,4.607455),
              (-74.177471,4.607299),
              (-74.177386,4.607104),
              (-74.177378,4.606885),
              (-74.177393,4.606518),
              (-74.177379,4.606393),
              (-74.177496,4.606331),
              (-74.177557,4.606321),
              (-74.177602,4.606295),
              (-74.177817,4.606273),
              (-74.177817,4.60627),
              (-74.178018,4.606228),
              (-74.178217,4.606167),
              (-74.178329,4.606144),
              (-74.178473,4.606087),
              (-74.178578,4.605945),
              (-74.178639,4.60572),
              (-74.178655,4.605457),
              (-74.178607,4.605261),
              (-74.178495,4.605094),
              (-74.178345,4.604998),
              (-74.178156,4.604927),
              (-74.177993,4.604901),
              (-74.177849,4.60493),
              (-74.177714,4.604998),
              (-74.177605,4.605078),
              (-74.177535,4.605152),
              (-74.177471,4.605187),
              (-74.177397,4.605187),
              (-74.177298,4.605165),
              (-74.177138,4.605174),
              (-74.176875,4.605126),
              (-74.176792,4.60512),
              (-74.176706,4.605126),
              (-74.176648,4.605178),
              (-74.176583,4.605332),
              (-74.176432,4.605014),
              (-74.176198,4.604686),
              (-74.176113,4.604405),
              (-74.176113,4.603623),
              (-74.176121,4.603519),
              (-74.176164,4.603374),
              (-74.176225,4.603222),
              (-74.176283,4.603156),
              (-74.176413,4.603044),
              (-74.176739,4.602783),
              (-74.177129,4.602557),
              (-74.177424,4.602362),
              (-74.177705,4.60208),
              (-74.17779,4.601776),
              (-74.177767,4.60144),
              (-74.177814,4.601213),
              (-74.177751,4.601072),
              (-74.177572,4.600955),
              (-74.177308,4.600901),
              (-74.17677,4.600955),
              (-74.176288,4.601026),
              (-74.175953,4.601244),
              (-74.175821,4.601619),
              (-74.17575,4.601947),
              (-74.175735,4.602151),
              (-74.175772,4.602221),
              (-74.175789,4.602321),
              (-74.175809,4.602471),
              (-74.175833,4.602547),
              (-74.175898,4.60283),
              (-74.175906,4.60294),
              (-74.175712,4.603299),
              (-74.175626,4.603416),
              (-74.17554,4.603424),
              (-74.174871,4.603307),
              (-74.174567,4.603205),
              (-74.17387,4.603123),
              (-74.173621,4.603155),
              (-74.173294,4.603202),
              (-74.173107,4.603217),
              (-74.172889,4.603155),
              (-74.172827,4.602967),
              (-74.172905,4.602686),
              (-74.173123,4.602358),
              (-74.173481,4.602108),
              (-74.173714,4.60203),
              (-74.17389,4.6019),
              (-74.17409,4.601785),
              (-74.174264,4.601695),
              (-74.174409,4.601511),
              (-74.174532,4.601353),
              (-74.174562,4.601242),
              (-74.174515,4.601076),
              (-74.17446,4.600935),
              (-74.174417,4.600798),
              (-74.174319,4.60061),
              (-74.174251,4.600486),
              (-74.174009,4.60017),
              (-74.173838,4.60011),
              (-74.173711,4.60017),
              (-74.173494,4.600302),
              (-74.173345,4.600392),
              (-74.173106,4.600439),
              (-74.172668,4.600533),
              (-74.172229,4.600717),
              (-74.171969,4.600794),
              (-74.171765,4.600841),
              (-74.171327,4.600785),
              (-74.170939,4.600734),
              (-74.170598,4.600685),
              (-74.170352,4.600603),
              (-74.170204,4.600553),
              (-74.17008,4.600561),
              (-74.169998,4.600652),
              (-74.169941,4.600842),
              (-74.170007,4.601113),
              (-74.170097,4.601328),
              (-74.170171,4.601558),
              (-74.170163,4.601798),
              (-74.170064,4.602061),
              (-74.169908,4.602243),
              (-74.169744,4.602284),
              (-74.169489,4.602317),
              (-74.169259,4.6023),
              (-74.169103,4.602341),
              (-74.168996,4.602523),
              (-74.168972,4.602819),
              (-74.168988,4.603108),
              (-74.169021,4.603372),
              (-74.16898,4.603627),
              (-74.168873,4.603874),
              (-74.168783,4.604047),
              (-74.168594,4.604245),
              (-74.16843,4.604311),
              (-74.168126,4.604393),
              (-74.167765,4.60436),
              (-74.167444,4.60441),
              (-74.167173,4.604517),
              (-74.166853,4.604723),
              (-74.166648,4.60483),
              (-74.165625,4.605395),
              (-74.165354,4.605527),
              (-74.165001,4.605659),
              (-74.164788,4.605691),
              (-74.164377,4.605815),
              (-74.163531,4.606235),
              (-74.163293,4.606318),
              (-74.163145,4.606343),
              (-74.162685,4.606285),
              (-74.162307,4.606178),
              (-74.161905,4.606106),
              (-74.159539,4.605495),
              (-74.159136,4.605314),
              (-74.158691,4.605044),
              (-74.156979,4.604083),
              (-74.156837,4.60399),
              (-74.156813,4.603816),
              (-74.156665,4.603193),
              (-74.156585,4.603074),
              (-74.156436,4.603004),
              (-74.156267,4.602986),
              (-74.156054,4.602974),
              (-74.155727,4.60298),
              (-74.155425,4.602922),
              (-74.155118,4.602765),
              (-74.154751,4.602513),
              (-74.154496,4.602198),
              (-74.154144,4.601913),
              (-74.153684,4.601425),
              (-74.153601,4.601187),
              (-74.153492,4.600983),
              (-74.153159,4.601008),
              (-74.15247,4.600893),
              (-74.152241,4.600683),
              (-74.15215,4.600477),
              (-74.152141,4.600108),
              (-74.15216,4.599759),
              (-74.152178,4.59925),
              (-74.151969,4.598714),
              (-74.151497,4.598405),
              (-74.151206,4.597907),
              (-74.15105,4.597738),
              (-74.150708,4.597499),
              (-74.150565,4.597303),
              (-74.150488,4.597076),
              (-74.150433,4.596936),
              (-74.150235,4.596793),
              (-74.150095,4.596652),
              (-74.149987,4.596489),
              (-74.14994,4.59632),
              (-74.149849,4.596262),
              (-74.149788,4.596172),
              (-74.14975,4.596124),
              (-74.149718,4.596071),
              (-74.149694,4.596014),
              (-74.149678,4.595955),
              (-74.14967,4.595893),
              (-74.14967,4.595832),
              (-74.149679,4.595771),
              (-74.149695,4.595711),
              (-74.14972,4.595655),
              (-74.149772,4.59562),
              (-74.149831,4.595605),
              (-74.149892,4.595597),
              (-74.150008,4.5956),
              (-74.150067,4.595626),
              (-74.150095,4.59568),
              (-74.150125,4.595734),
              (-74.150156,4.595788),
              (-74.150188,4.59584),
              (-74.150221,4.595892),
              (-74.150256,4.595943),
              (-74.150291,4.595993),
              (-74.150328,4.596043),
              (-74.150366,4.596091),
              (-74.150405,4.596139),
              (-74.150446,4.596186),
              (-74.150488,4.596231),
              (-74.150532,4.596273),
              (-74.150579,4.596314),
              (-74.150627,4.596351),
              (-74.150678,4.596386),
              (-74.15073,4.596419),
              (-74.150784,4.596448),
              (-74.150839,4.596475),
              (-74.150896,4.596499),
              (-74.150954,4.59652),
              (-74.151013,4.596538),
              (-74.151072,4.596552),
              (-74.151133,4.596564),
              (-74.151194,4.596571),
              (-74.151255,4.596569),
              (-74.151316,4.596564),
              (-74.151377,4.596555),
              (-74.151437,4.596543),
              (-74.151497,4.596527),
              (-74.151555,4.596508),
              (-74.151612,4.596485),
              (-74.151668,4.59646),
              (-74.151722,4.596431),
              (-74.151775,4.596399),
              (-74.151826,4.596364),
              (-74.151874,4.596326),
              (-74.151921,4.596286),
              (-74.151964,4.596243),
              (-74.152006,4.596197),
              (-74.152044,4.596149),
              (-74.15208,4.596099),
              (-74.152113,4.596047),
              (-74.152143,4.595993),
              (-74.152264,4.595687),
              (-74.151726,4.595473),
              (-74.151236,4.595393),
              (-74.149147,4.595133),
              (-74.148491,4.59506),
              (-74.147797,4.595016),
              (-74.146944,4.594956),
              (-74.146338,4.594927),
              (-74.145641,4.59499),
              (-74.145374,4.595065),
              (-74.145109,4.595138),
              (-74.144018,4.595337),
              (-74.143243,4.5954),
              (-74.142586,4.595473),
              (-74.141811,4.595464),
              (-74.141081,4.595437),
              (-74.140433,4.595364),
              (-74.137766,4.594885),
              (-74.137568,4.595482),
              (-74.137433,4.595879),
              (-74.137313,4.596212),
              (-74.130257,4.606957),
              (-74.129728,4.607915),
              (-74.129265,4.608855),
              (-74.129086,4.609248),
              (-74.12893,4.60973),
              (-74.128549,4.61071),
              (-74.124582,4.623643),
              (-74.124503,4.623924),
              (-74.124153,4.624822),
              (-74.12397,4.625244),
              (-74.123695,4.625895),
              (-74.11963,4.635855),
              (-74.119524,4.636108),
              (-74.11939,4.636312),
              (-74.119246,4.6365),
              (-74.119077,4.636668),
              (-74.118446,4.63727),
              (-74.118299,4.637412),
              (-74.118535,4.637562),
              (-74.118957,4.637843),
              (-74.119377,4.638107),
              (-74.120039,4.638526),
              (-74.120313,4.638731),
              (-74.120729,4.639015),
              (-74.120837,4.639072),
              (-74.12149,4.639569),
              (-74.121623,4.639673),
              (-74.122126,4.640066),
              (-74.122247,4.640163),
              (-74.122924,4.640724),
              (-74.123022,4.640861),
              (-74.123102,4.641028),
              (-74.123635,4.640714),
              (-74.123812,4.640869),
              (-74.123889,4.641024),
              (-74.124215,4.641465),
              (-74.124334,4.641588),
              (-74.124441,4.641716),
              (-74.124498,4.641974),
              (-74.124667,4.642382),
              (-74.124747,4.642638),
              (-74.124836,4.64288),
              (-74.124981,4.643307),
              (-74.125118,4.643728),
              (-74.125276,4.644228),
              (-74.125504,4.644757),
              (-74.125655,4.645238),
              (-74.125953,4.64556),
              (-74.126488,4.646032),
              (-74.127186,4.646569),
              (-74.127914,4.647144),
              (-74.128085,4.647275),
              (-74.128325,4.647488),
              (-74.128785,4.647959),
              (-74.128912,4.648018),
              (-74.128933,4.648113),
              (-74.128987,4.648189),
              (-74.128978,4.648269),
              (-74.129009,4.648361),
              (-74.129175,4.648527),
              (-74.129295,4.64858),
              (-74.129606,4.64869),
              (-74.129931,4.648779),
              (-74.130265,4.648856),
              (-74.130613,4.648924),
              (-74.130856,4.648972),
              (-74.131016,4.649),
              (-74.131251,4.648887),
              (-74.131465,4.648769),
              (-74.131757,4.648802),
              (-74.132007,4.648839),
              (-74.13221,4.648877),
              (-74.132317,4.648895),
              (-74.132386,4.6491),
              (-74.132395,4.649226),
              (-74.132375,4.64934),
              (-74.132356,4.649539),
              (-74.132384,4.649633),
              (-74.132479,4.649812),
              (-74.132702,4.649955),
              (-74.132883,4.650048),
              (-74.133071,4.650273),
              (-74.133217,4.650544),
              (-74.133267,4.650797),
              (-74.133269,4.65096),
              (-74.133269,4.651232),
              (-74.133495,4.65175),
              (-74.133641,4.652098),
              (-74.133797,4.652477),
              (-74.134013,4.652767),
              (-74.134121,4.652998),
              (-74.134222,4.653199),
              (-74.1343,4.653484),
              (-74.134412,4.653722),
              (-74.134591,4.653939),
              (-74.134701,4.654174),
              (-74.134771,4.654451),
              (-74.134885,4.654718),
              (-74.135019,4.654892),
              (-74.135089,4.655061),
              (-74.135213,4.655306),
              (-74.135361,4.655554),
              (-74.135503,4.655811),
              (-74.135552,4.655979),
              (-74.135639,4.656125),
              (-74.135753,4.656399),
              (-74.135881,4.656651),
              (-74.135998,4.656834),
              (-74.136064,4.656991),
              (-74.136116,4.65716),
              (-74.136222,4.657358),
              (-74.136328,4.657537),
              (-74.136471,4.65759),
              (-74.136667,4.6576),
              (-74.136911,4.657795),
              (-74.137029,4.657962),
              (-74.137134,4.658101),
              (-74.137191,4.658214),
              (-74.137177,4.65837),
              (-74.137121,4.658552),
              (-74.137046,4.65867),
              (-74.137078,4.65879),
              (-74.137125,4.658852),
              (-74.137176,4.658901),
              (-74.137415,4.658981),
              (-74.137497,4.658989),
              (-74.137646,4.659084),
              (-74.137799,4.659219),
              (-74.137945,4.659366),
              (-74.137998,4.65945),
              (-74.138098,4.659573),
              (-74.138249,4.659686),
              (-74.138441,4.659847),
              (-74.138551,4.659954),
              (-74.138695,4.660046),
              (-74.138868,4.660219),
              (-74.139033,4.660431),
              (-74.13928,4.660565),
              (-74.139384,4.660574),
              (-74.13956,4.660573),
              (-74.139738,4.660615),
              (-74.139787,4.660774),
              (-74.139817,4.660907),
              (-74.139801,4.66106),
              (-74.139815,4.661171),
              (-74.13983,4.661347),
              (-74.139882,4.661467),
              (-74.14,4.661538),
              (-74.140103,4.661629),
              (-74.140234,4.661712),
              (-74.140304,4.661915),
              (-74.140411,4.662155),
              (-74.140588,4.662387),
              (-74.14073,4.662594),
              (-74.140858,4.662733),
              (-74.140945,4.66284),
              (-74.14109,4.662916),
              (-74.141273,4.662995),
              (-74.14152,4.663009),
              (-74.141716,4.662996),
              (-74.141886,4.662967),
              (-74.142054,4.662878),
              (-74.142197,4.662824),
              (-74.142379,4.662731),
              (-74.142546,4.662669),
              (-74.142645,4.662527),
              (-74.142776,4.662463),
              (-74.142892,4.662385),
              (-74.143035,4.662282),
              (-74.143126,4.662144),
              (-74.143192,4.662072),
              (-74.143275,4.662),
              (-74.14334,4.661937),
              (-74.143414,4.661876),
              (-74.143499,4.661836),
              (-74.143628,4.661788),
              (-74.143764,4.661745),
              (-74.143892,4.661731),
              (-74.14399,4.661754),
              (-74.144085,4.661781),
              (-74.144198,4.661826),
              (-74.144359,4.661781),
              (-74.144484,4.661712),
              (-74.144531,4.661589),
              (-74.144561,4.661491),
              (-74.144608,4.661371),
              (-74.144683,4.66126),
              (-74.144805,4.661228),
              (-74.144882,4.661282),
              (-74.144949,4.661351),
              (-74.145016,4.661442),
              (-74.145067,4.661528),
              (-74.145206,4.661692),
              (-74.145252,4.661881),
              (-74.145298,4.661943),
              (-74.145397,4.661969),
              (-74.145529,4.661953),
              (-74.145627,4.661888),
              (-74.145808,4.661803),
              (-74.145924,4.66176),
              (-74.146018,4.661785),
              (-74.146071,4.661825),
              (-74.146125,4.661898),
              (-74.146182,4.661922),
              (-74.146286,4.661983),
              (-74.146359,4.662019),
              (-74.146483,4.662028),
              (-74.146645,4.662033),
              (-74.146814,4.662056),
              (-74.147039,4.66209),
              (-74.147309,4.662194),
              (-74.147546,4.662272),
              (-74.147888,4.662453),
              (-74.148132,4.662562),
              (-74.148394,4.662694),
              (-74.148617,4.662843),
              (-74.149045,4.663105),
              (-74.149429,4.663293),
              (-74.149655,4.663462),
              (-74.149959,4.663619),
              (-74.15025,4.6637),
              (-74.150535,4.663859),
              (-74.150738,4.663987),
              (-74.150906,4.664088),
              (-74.151133,4.664172),
              (-74.151401,4.664249),
              (-74.151661,4.664218),
              (-74.151805,4.664223),
              (-74.151947,4.664242),
              (-74.15214,4.664194),
              (-74.152318,4.66415),
              (-74.152471,4.664116),
              (-74.152605,4.664076),
              (-74.15289,4.66401),
              (-74.15306,4.663969),
              (-74.153192,4.663926),
              (-74.15345,4.663923),
              (-74.153644,4.663904),
              (-74.154013,4.663953),
              (-74.154344,4.664154),
              (-74.154422,4.664209),
              (-74.154565,4.664266),
              (-74.154648,4.664155),
              (-74.154683,4.664015),
              (-74.154725,4.663898),
              (-74.154744,4.663652),
              (-74.154833,4.663463),
              (-74.154921,4.663308),
              (-74.154992,4.663184),
              (-74.155069,4.663087),
              (-74.155164,4.663014),
              (-74.155256,4.662951),
              (-74.155345,4.662904),
              (-74.155443,4.662926),
              (-74.155524,4.662948),
              (-74.155679,4.662989),
              (-74.155825,4.662923),
              (-74.156035,4.662744),
              (-74.156092,4.662569),
              (-74.15621,4.66246),
              (-74.156281,4.662329),
              (-74.15633,4.662193),
              (-74.15644,4.662052),
              (-74.156522,4.66187),
              (-74.156571,4.661789),
              (-74.156703,4.661723),
              (-74.156857,4.661645),
              (-74.156959,4.6616),
              (-74.15708,4.66153),
              (-74.157294,4.661715),
              (-74.157433,4.661824),
              (-74.157583,4.661996),
              (-74.157619,4.662092),
              (-74.157726,4.662216),
              (-74.157878,4.66235),
              (-74.158023,4.66243),
              (-74.15816,4.662475),
              (-74.158271,4.662567),
              (-74.158451,4.662675),
              (-74.158572,4.662739)
        ]
      
#                   latitud     longitud                 
# initialCordenate = (4.670540, -74.185523)
initialCordenate = (4.655420, -74.185523)
finalCordenate  =  (4.585975, -74.122538)
imageLatitud = initialCordenate[0]
imageLongitud = initialCordenate[1]
# crate associate image directory and image collection javaScript file
outFile = None
print("new directory: %s" %  imgsJsDirPath)
print("new js file: %s" %  imgsJsPath)
if not os.path.exists(imgsJsDirPath):
	os.makedirs(imgsJsDirPath)
	outFile = open(imgsJsPath, "w+")
	outFile.write("var set_%s =\n [" % (cityZone))
	outFile.close()

outF = open(imgsJsPath, "a")	
flag4comma = False


heading_lists = [0,45,90,135,180,-45,-90,-135]
headingIndex = 0
while imageLatitud >= finalCordenate[0]:
       while imageLongitud <= finalCordenate[1]:
              location = "%f,%f" % (imageLatitud, imageLongitud)
              heading = heading_lists[headingIndex ]
              urlmeta = "https://maps.googleapis.com/maps/api/streetview/metadata?size=600x300&location=%s&fov=100&heading=%i&pitch=0&key={CopyYourKeyHere}" % (location, heading)
              url = "https://maps.googleapis.com/maps/api/streetview?size=600x300&location=%s&fov=100&heading=%i&pitch=0&key={CopyYourKeyHere}" % (location, heading)
              print('location')
              print(location)
              try:
                     r = requests.get(urlmeta)
                     data = json.loads(r.text)
                     print('meta_data')
                     print(data)
                     if r.status_code == 200 and data["status"] == 'OK' and ('oogle' in data["copyright"]):
                            try:
                                   point_x = data['location']['lng']
                                   point_y = data['location']['lat']
                                   if point_in_poly(point_x,point_y,polygon) == True:
                                          dateTime = datetime.datetime.now().strftime("%I:%M%p on %B %d, %Y")
                                          imgName = "%s_%s_%i.jpg" %(data['location']['lat'],data['location']['lng'],heading)
                                          location = "%s,%s" % (data['location']['lat'],data['location']['lng'])
                                          url = "https://maps.googleapis.com/maps/api/streetview?size=600x300&location=%s&fov=100&heading=%i&pitch=0&key={CopyYourKeyHere}" % (location, heading)
                                          print(url)
                                          try:
                                                 urllib.urlretrieve(url, os.path.join(imgsJsDirPath,imgName))
                                                 if flag4comma:
                                                        outF.write(",\n")
                                                 outF.write("{\"name\":\"%s\", \"lat\":%s, \"log\":%s, \"sampletime\":\"%s\", \"heading\":%i}" %(imgName,data['location']['lat'],data['location']['lng'],data['date'],heading))
                                                 flag4comma = True
                                                 print('point is into polygon =)') 
                                                 time.sleep(3)
                                          except(HTTPError, ConnectionError, Timeout, RateLimitExceeded, timeout) as e:
                                                 print("urllib.urlretrieve fail =(: %s" % str(e))
                                                 print("longitud %f latitud %f heading %f" %(imageLongitud, imageLatitud, headingIndex))
                                   else:
                                          print('point is NOT into polygon =(')
                            except(HTTPError, ConnectionError, Timeout, RateLimitExceeded, timeout) as e:
                                   print("image access fail =(: %s" % str(e))
                                   print("longitud %f latitud %f heading %f" %(imageLongitud, imageLatitud, headingIndex))
                     imageLongitud = imageLongitud + DELTA2
                     headingIndex = (headingIndex + 1)%8
              except(HTTPError, ConnectionError, Timeout, RateLimitExceeded, timeout) as e:
                     print("metadata access fail =(: %s" % str(e))
                     print("longitud %f latitud %f heading %f" %(imageLongitud, imageLatitud, headingIndex))
        
       imageLatitud = imageLatitud - DELTA2
       imageLongitud = initialCordenate[1]


print("longitud %f latitud %f heading %f" %(imageLongitud, imageLatitud, headingIndex))      

outF.write("]\n")
outF.close()
	





